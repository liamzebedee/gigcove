<article class="gig gig-editable"><div class="gig-inner">

  <aside class="left">
    <h2>Details</h2>
    <div>
      <span>Costs $</span><span contenteditable type="number" min="0" max="100" pattern="[0-9]*" class="ticket-cost"><%= gig.ticket_cost.to_i %></span>
      <%= f.hidden_field(:ticket_cost) %>
    </div>
    
    <div>
    <p class="gig-times">
      <span>Starts on the <span contenteditable class="input-date start" placeholder="dd/mm/yyyy"><%= gig.start_date_str %></span> at <span type="text" class="input-time start" placeholder="time"><%= gig.start_time_str %></span><span> and goes till </span><span size=7 type="text" class="input-time end" placeholder="time"><%= gig.end_time_str %></span>
    </p>

    <%= f.hidden_field(:start_time) %>
    <%= f.hidden_field(:end_time) %>
    </div>

    <div class="gig-venue">
      <h2>Venue</h2>
      <%= fields_for :venue, gig.venue do |venue_fields| %>
        <% if gig.new_record? %>
          <input type="text" class="gig-venue-name" data-ajax="<%= venues_path %>" placeholder="Enter the venue name" value="<%= gig.venue.name %>"/>

          <div class="new-venue-info">
            <% if gig.venue.nil? %>
              <%= venue_fields.file_field :cover_image, { accept: "image/*" } %>
              <strong><span class="glyphicon glyphicon-picture"></span> Cover image: </strong><button type="button" class="btn btn-primary" id="venue-select-cover-image">Select</button><br>
            <% else %>
              <%= gig.venue.cover_image.url %>
              <%= image_tag(gig.venue.cover_image) if gig.venue.cover_image? %>
            <% end %>

            <strong><span class="glyphicon glyphicon-map-marker"></span> Location: </strong><span contenteditable class="gig-venue-location" placeholder="12 Example Street, South Bank QLD 4000, Australia"><%= gig.venue.location if not gig.venue.nil? %></span>
          </div>

            <%= venue_fields.hidden_field(:name, {value: gig.venue.name}) %>
            <%= venue_fields.hidden_field(:location, {value: gig.venue.location}) %>
            <%= venue_fields.hidden_field(:id) %>
        <% else %>
          <strong><%= gig.venue.name %> <small>(<a href="<%= edit_venue_path gig.venue %>">Edit</a>)</small></strong>
        <% end %>
      <% end %>
    </div>
  </aside><!-- .left -->

  <div class="main">
    <h1><span class="gig-title" contenteditable="true" placeholder="Gig title"><%= gig.title %></span></h1>
    <%= f.hidden_field(:title) %>
    
    <div>Source: <small class="link-to-source" contenteditable="true" placeholder="Link to source"><%= gig.link_to_source %></small></div>
    <%= f.hidden_field(:link_to_source) %>
    
    <div><textarea class="description form-control" rows="3" placeholder="Description"><%= gig.description %></textarea></div>
    <%= f.hidden_field(:description) %>
    
    <div>
      <h3>Genres</h3>
      <input type="text" class="gig-genres" data-ajax="<%= genres_path %>" placeholder="What types of music will be playing?" value="<%= gig.genres_str %>"/>
    </div>
    <%= f.hidden_field(:genres, value: gig.genres_str) %>

    <div>
      <h3>Artists</h3>
      <input type="text" class="gig-artists" data-ajax="<%= artists_path %>" placeholder="Who's playing?" value="<%= gig.artists_str %>"/>
    </div>
    <%= f.hidden_field(:performances, value: gig.artists_str) %>

  </div><!-- .main -->

</div></article><!-- .gig -->